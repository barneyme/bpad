<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>bPad</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                background: white;
                min-height: 100vh;
                padding: 20px;
            }

            .container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                grid-template-rows: 1fr 1fr;
                gap: 20px;
                max-width: 1400px;
                margin: 0 auto;
                height: calc(100vh - 40px);
            }

            .panel {
                background: rgba(255, 255, 255, 0.95);
                border-radius: 15px;
                padding: 25px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                overflow-y: auto;
            }

            .file-manager {
                grid-row: 1 / -1;
            }

            .calendar {
                grid-column: 2;
                grid-row: 1;
            }

            .todo {
                grid-column: 2;
                grid-row: 2;
            }

            h2 {
                color: #4a5568;
                margin-bottom: 20px;
                font-size: 1.5em;
                border-bottom: 2px solid #e2e8f0;
                padding-bottom: 10px;
            }

            /* File Manager Styles */
            .file-controls {
                display: flex;
                gap: 10px;
                margin-bottom: 20px;
                flex-wrap: wrap;
            }

            .btn {
                background: linear-gradient(135deg, #4299e1, #3182ce);
                color: white;
                border: none;
                padding: 10px 15px;
                border-radius: 8px;
                cursor: pointer;
                font-size: 14px;
                transition: all 0.3s ease;
            }

            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);
            }

            .btn:active {
                transform: translateY(0);
            }

            .file-input {
                display: none;
            }

            .file-list {
                margin-bottom: 20px;
                max-height: 150px;
                overflow-y: auto;
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                padding: 10px;
            }

            .file-item {
                padding: 8px;
                cursor: pointer;
                border-radius: 5px;
                margin-bottom: 5px;
                transition: background-color 0.2s;
            }

            .file-item:hover {
                background-color: #f7fafc;
            }

            .file-item.active {
                background-color: #e6fffa;
                border-left: 4px solid #38b2ac;
            }

            .text-editor {
                width: 100%;
                min-height: 300px;
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                padding: 15px;
                font-family: "Courier New", monospace;
                font-size: 14px;
                resize: vertical;
                background: #fafafa;
                line-height: 1.5;
            }

            .text-editor:focus {
                outline: none;
                border-color: #4299e1;
                box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
            }

            /* Calendar Styles */
            .calendar-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
            }

            .calendar-nav {
                background: #4299e1;
                color: white;
                border: none;
                padding: 8px 12px;
                border-radius: 5px;
                cursor: pointer;
            }

            .calendar-grid {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 2px;
                margin-bottom: 20px;
            }

            .calendar-day {
                aspect-ratio: 1;
                display: flex;
                align-items: center;
                justify-content: center;
                background: #f8f9fa;
                border-radius: 5px;
                cursor: pointer;
                transition: all 0.2s;
                font-size: 12px;
                position: relative;
            }

            .calendar-day:hover {
                background: #e9ecef;
                transform: scale(1.05);
            }

            .calendar-day.today {
                background: #4299e1;
                color: white;
                font-weight: bold;
            }

            .calendar-day.has-events {
                background: #38b2ac;
                color: white;
            }

            .calendar-day.selected {
                background: #667eea;
                color: white;
                box-shadow: 0 0 0 2px #4299e1;
            }

            .day-header {
                font-weight: bold;
                background: #e2e8f0;
                color: #4a5568;
            }

            .event-input {
                width: 100%;
                padding: 10px;
                border: 1px solid #e2e8f0;
                border-radius: 5px;
                margin-bottom: 10px;
            }

            .events-list {
                max-height: 150px;
                overflow-y: auto;
                border: 1px solid #e2e8f0;
                border-radius: 5px;
                padding: 10px;
            }

            .event-item {
                background: #f0fff4;
                padding: 8px;
                margin-bottom: 5px;
                border-radius: 5px;
                border-left: 4px solid #38b2ac;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .delete-btn {
                background: #e53e3e;
                color: white;
                border: none;
                padding: 4px 8px;
                border-radius: 3px;
                cursor: pointer;
                font-size: 12px;
            }

            /* Todo Styles */
            .todo-input {
                width: calc(100% - 90px);
                padding: 10px;
                border: 1px solid #e2e8f0;
                border-radius: 5px;
                margin-bottom: 15px;
            }

            .add-todo-btn {
                width: 80px;
                margin-left: 10px;
            }

            .todo-list {
                max-height: 250px;
                overflow-y: auto;
            }

            .todo-item {
                display: flex;
                align-items: center;
                padding: 10px;
                background: #f8f9fa;
                margin-bottom: 8px;
                border-radius: 8px;
                transition: all 0.2s;
            }

            .todo-item:hover {
                transform: translateX(5px);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }

            .todo-item.completed {
                background: #f0fff4;
                text-decoration: line-through;
                opacity: 0.7;
            }

            .todo-checkbox {
                margin-right: 10px;
                transform: scale(1.2);
            }

            .todo-text {
                flex: 1;
                font-size: 14px;
            }

            .todo-controls {
                display: flex;
                gap: 10px;
                margin-bottom: 15px;
            }

            .filename-input {
                width: 200px;
                padding: 8px;
                border: 1px solid #e2e8f0;
                border-radius: 5px;
                margin-right: 10px;
            }

            @media (max-width: 1024px) {
                .container {
                    grid-template-columns: 1fr;
                    grid-template-rows: auto auto auto;
                    gap: 15px;
                }

                .file-manager,
                .calendar,
                .todo {
                    grid-column: 1;
                    grid-row: auto;
                }

                .panel {
                    padding: 20px;
                }

                .file-controls {
                    flex-direction: column;
                    gap: 8px;
                }

                .file-controls .btn {
                    width: 100%;
                }

                .filename-input {
                    width: 100%;
                    margin-right: 0;
                    margin-bottom: 10px;
                }
            }

            @media (max-width: 768px) {
                body {
                    padding: 10px;
                }

                .container {
                    height: auto;
                    gap: 10px;
                }

                .panel {
                    padding: 15px;
                }

                h2 {
                    font-size: 1.3em;
                    margin-bottom: 15px;
                }

                .text-editor {
                    min-height: 200px;
                    font-size: 16px; /* Prevents zoom on iOS */
                }

                .calendar-grid {
                    gap: 1px;
                }

                .calendar-day {
                    font-size: 11px;
                    min-height: 35px;
                    aspect-ratio: auto;
                }

                .btn {
                    padding: 12px 15px;
                    font-size: 16px; /* Prevents zoom on iOS */
                }

                .event-input,
                .todo-input,
                .filename-input {
                    font-size: 16px; /* Prevents zoom on iOS */
                    padding: 12px;
                }

                .todo-input {
                    width: calc(100% - 100px);
                }

                .add-todo-btn {
                    width: 90px;
                }
            }

            @media (max-width: 480px) {
                .file-controls {
                    gap: 5px;
                }

                .calendar-header {
                    flex-direction: column;
                    gap: 10px;
                    text-align: center;
                }

                .calendar-nav {
                    padding: 10px 20px;
                }

                #currentMonth {
                    font-size: 1.1em;
                    font-weight: bold;
                }

                .calendar-day {
                    min-height: 30px;
                    font-size: 10px;
                }

                .todo-item {
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 8px;
                }

                .todo-item .delete-btn {
                    align-self: flex-end;
                }

                .todo-controls {
                    flex-direction: column;
                    gap: 8px;
                }

                .todo-controls .btn {
                    width: 100%;
                }

                .event-item {
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 8px;
                }

                .event-item .delete-btn {
                    align-self: flex-end;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <!-- File Manager -->
            <div class="panel file-manager">
                <h2>📁 Files</h2>
                <div class="file-controls">
                    <button class="btn" onclick="createNewFile()">New</button>
                    <button
                        class="btn"
                        onclick="document.getElementById('fileInput').click()"
                    >
                        Open
                    </button>
                    <button class="btn" onclick="saveCurrentFile()">
                        Save
                    </button>
                    <input
                        type="file"
                        id="fileInput"
                        class="file-input"
                        accept=".txt"
                        onchange="openFile(event)"
                    />
                    <input
                        type="text"
                        id="filenameInput"
                        class="filename-input"
                        placeholder="filename.txt"
                        value="untitled.txt"
                    />
                </div>
                <div class="file-list" id="fileList"></div>
                <textarea
                    class="text-editor"
                    id="textEditor"
                    placeholder="Start typing your text here..."
                ></textarea>
            </div>

            <!-- Calendar -->
            <div class="panel calendar">
                <h2>📅 Calendar</h2>
                <div
                    style="
                        display: flex;
                        gap: 10px;
                        margin-bottom: 15px;
                        flex-wrap: wrap;
                    "
                >
                    <input
                        type="text"
                        class="event-input"
                        id="eventInput"
                        placeholder="Add event for selected date..."
                        style="flex: 1; margin-bottom: 0"
                    />
                    <button class="btn" onclick="addEvent()">Add</button>
                    <button class="btn" onclick="saveCalendar()">Save</button>
                    <button class="btn" onclick="loadCalendar()">Load</button>
                </div>
                <div class="calendar-header">
                    <button class="calendar-nav" onclick="previousMonth()">
                        &lt;
                    </button>
                    <span id="currentMonth"></span>
                    <button class="calendar-nav" onclick="nextMonth()">
                        &gt;
                    </button>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
                <div class="events-list" id="eventsList"></div>
            </div>

            <!-- Todo List -->
            <div class="panel todo">
                <h2>✅ Todo</h2>
                <div
                    style="
                        display: flex;
                        align-items: center;
                        margin-bottom: 15px;
                    "
                >
                    <input
                        type="text"
                        class="todo-input"
                        id="todoInput"
                        placeholder="Add a new task..."
                    />
                    <button class="btn add-todo-btn" onclick="addTodo()">
                        Add
                    </button>
                </div>
                <div class="todo-controls">
                    <button class="btn" onclick="saveTodos()">Save</button>
                    <button class="btn" onclick="loadTodos()">Load</button>
                    <button class="btn" onclick="clearCompleted()">
                        Clear
                    </button>
                </div>
                <div class="todo-list" id="todoList"></div>
            </div>
        </div>

        <script>
            // File Manager with localStorage
            let currentFiles =
                JSON.parse(localStorage.getItem("currentFiles")) || {};
            let activeFile = localStorage.getItem("activeFile") || null;

            function createNewFile() {
                const filename =
                    document.getElementById("filenameInput").value ||
                    "untitled.txt";
                currentFiles[filename] = "";
                activeFile = filename;
                document.getElementById("textEditor").value = "";
                updateFileList();
                saveToStorage();
            }

            function openFile(event) {
                const file = event.target.files[0];
                if (file && file.type === "text/plain") {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const filename = file.name;
                        const content = e.target.result;
                        currentFiles[filename] = content;
                        activeFile = filename;
                        document.getElementById("textEditor").value = content;
                        document.getElementById("filenameInput").value =
                            filename;
                        updateFileList();
                        saveToStorage();
                    };
                    reader.readAsText(file);
                }
            }

            function saveCurrentFile() {
                if (!activeFile) {
                    createNewFile();
                }

                const content = document.getElementById("textEditor").value;
                const filename =
                    document.getElementById("filenameInput").value ||
                    activeFile;

                // Update the file content
                if (activeFile && activeFile !== filename) {
                    delete currentFiles[activeFile];
                }
                currentFiles[filename] = content;
                activeFile = filename;

                // Download the file
                const blob = new Blob([content], { type: "text/plain" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                updateFileList();
                saveToStorage();
            }

            function updateFileList() {
                const fileList = document.getElementById("fileList");
                fileList.innerHTML = "";

                Object.keys(currentFiles).forEach((filename) => {
                    const fileItem = document.createElement("div");
                    fileItem.className = "file-item";
                    if (filename === activeFile) {
                        fileItem.classList.add("active");
                    }
                    fileItem.textContent = filename;
                    fileItem.onclick = () => selectFile(filename);
                    fileList.appendChild(fileItem);
                });
            }

            function selectFile(filename) {
                activeFile = filename;
                document.getElementById("textEditor").value =
                    currentFiles[filename];
                document.getElementById("filenameInput").value = filename;
                updateFileList();
                saveToStorage();
            }

            function saveToStorage() {
                localStorage.setItem(
                    "currentFiles",
                    JSON.stringify(currentFiles),
                );
                localStorage.setItem("activeFile", activeFile);
            }

            // Update current file content when typing
            document
                .getElementById("textEditor")
                .addEventListener("input", function () {
                    if (activeFile) {
                        currentFiles[activeFile] = this.value;
                        saveToStorage();
                    }
                });

            // Load file state on startup
            function loadFileState() {
                if (activeFile && currentFiles[activeFile] !== undefined) {
                    document.getElementById("textEditor").value =
                        currentFiles[activeFile];
                    document.getElementById("filenameInput").value = activeFile;
                    updateFileList();
                } else if (Object.keys(currentFiles).length === 0) {
                    createNewFile();
                } else {
                    updateFileList();
                }
            }

            // Calendar with localStorage
            let currentDate = new Date();
            let selectedDate = localStorage.getItem("selectedDate") || null;
            let calendarEvents =
                JSON.parse(localStorage.getItem("calendarEvents")) || {};

            function saveCalendarToStorage() {
                localStorage.setItem(
                    "calendarEvents",
                    JSON.stringify(calendarEvents),
                );
                localStorage.setItem("selectedDate", selectedDate);
            }

            function renderCalendar() {
                const grid = document.getElementById("calendarGrid");
                const monthYear = document.getElementById("currentMonth");

                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();

                monthYear.textContent = new Date(
                    year,
                    month,
                ).toLocaleDateString("en-US", {
                    month: "long",
                    year: "numeric",
                });

                grid.innerHTML = "";

                // Add day headers
                const dayHeaders = [
                    "Sun",
                    "Mon",
                    "Tue",
                    "Wed",
                    "Thu",
                    "Fri",
                    "Sat",
                ];
                dayHeaders.forEach((day) => {
                    const dayHeader = document.createElement("div");
                    dayHeader.className = "calendar-day day-header";
                    dayHeader.textContent = day;
                    grid.appendChild(dayHeader);
                });

                // Get first day of month and number of days
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                // Add empty cells for days before month starts
                for (let i = 0; i < firstDay; i++) {
                    const emptyDay = document.createElement("div");
                    emptyDay.className = "calendar-day";
                    grid.appendChild(emptyDay);
                }

                // Add days of the month
                const today = new Date();
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayElement = document.createElement("div");
                    dayElement.className = "calendar-day";
                    dayElement.textContent = day;

                    const dateKey = `${year}-${month + 1}-${day}`;

                    // Check if it's today
                    if (
                        year === today.getFullYear() &&
                        month === today.getMonth() &&
                        day === today.getDate()
                    ) {
                        dayElement.classList.add("today");
                    }

                    // Check if it has events
                    if (
                        calendarEvents[dateKey] &&
                        calendarEvents[dateKey].length > 0
                    ) {
                        dayElement.classList.add("has-events");
                    }

                    // Check if it's selected
                    if (selectedDate === dateKey) {
                        dayElement.classList.add("selected");
                    }

                    dayElement.onclick = () => selectDate(dateKey, dayElement);
                    grid.appendChild(dayElement);
                }
            }

            function selectDate(dateKey, element) {
                // Remove previous selection
                document
                    .querySelectorAll(".calendar-day.selected")
                    .forEach((el) => {
                        el.classList.remove("selected");
                    });

                // Add selection to current day
                element.classList.add("selected");
                selectedDate = dateKey;

                displayEventsForDate(dateKey);
            }

            function previousMonth() {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            }

            function nextMonth() {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            }

            function addEvent() {
                if (!selectedDate) {
                    alert("Please select a date first");
                    return;
                }

                const eventText = document
                    .getElementById("eventInput")
                    .value.trim();
                if (!eventText) return;

                if (!calendarEvents[selectedDate]) {
                    calendarEvents[selectedDate] = [];
                }

                calendarEvents[selectedDate].push(eventText);
                document.getElementById("eventInput").value = "";

                displayEventsForDate(selectedDate);
                renderCalendar(); // Refresh to show event indicator
                saveCalendarToStorage();
            }

            function displayEventsForDate(dateKey) {
                const eventsList = document.getElementById("eventsList");
                eventsList.innerHTML = "";

                if (calendarEvents[dateKey]) {
                    calendarEvents[dateKey].forEach((event, index) => {
                        const eventItem = document.createElement("div");
                        eventItem.className = "event-item";
                        eventItem.innerHTML = `
                        <span>${event}</span>
                        <button class="delete-btn" onclick="deleteEvent('${dateKey}', ${index})">×</button>
                    `;
                        eventsList.appendChild(eventItem);
                    });
                }
            }

            function deleteEvent(dateKey, index) {
                calendarEvents[dateKey].splice(index, 1);
                if (calendarEvents[dateKey].length === 0) {
                    delete calendarEvents[dateKey];
                }
                displayEventsForDate(dateKey);
                renderCalendar();
                saveCalendarToStorage();
            }

            function saveCalendar() {
                let data = "";
                Object.keys(calendarEvents)
                    .sort()
                    .forEach((dateKey) => {
                        const [year, month, day] = dateKey.split("-");
                        const date = new Date(year, month - 1, day);
                        const dateStr = date.toLocaleDateString("en-US", {
                            weekday: "short",
                            year: "numeric",
                            month: "short",
                            day: "numeric",
                        });
                        data += `${dateStr}:\n`;
                        calendarEvents[dateKey].forEach((event) => {
                            data += `  - ${event}\n`;
                        });
                        data += "\n";
                    });

                const blob = new Blob([data], { type: "text/plain" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "calendar_events.txt";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            function loadCalendar() {
                const input = document.createElement("input");
                input.type = "file";
                input.accept = ".txt";
                input.onchange = function (e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            try {
                                calendarEvents = {};
                                const lines = e.target.result.split("\n");
                                let currentDate = null;

                                lines.forEach((line) => {
                                    line = line.trim();
                                    if (line.endsWith(":")) {
                                        // Parse date line
                                        const dateStr = line.slice(0, -1);
                                        const date = new Date(dateStr);
                                        if (!isNaN(date.getTime())) {
                                            currentDate = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`;
                                            calendarEvents[currentDate] = [];
                                        }
                                    } else if (
                                        line.startsWith("- ") &&
                                        currentDate
                                    ) {
                                        // Parse event line
                                        const event = line.substring(2);
                                        if (event) {
                                            calendarEvents[currentDate].push(
                                                event,
                                            );
                                        }
                                    }
                                });

                                renderCalendar();
                                if (selectedDate) {
                                    displayEventsForDate(selectedDate);
                                }
                                saveCalendarToStorage();
                            } catch (error) {
                                alert("Error loading calendar file");
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            }

            // Todo List with localStorage
            let todos = JSON.parse(localStorage.getItem("todos")) || [];

            function saveTodosToStorage() {
                localStorage.setItem("todos", JSON.stringify(todos));
            }

            function addTodo() {
                const todoText = document
                    .getElementById("todoInput")
                    .value.trim();
                if (!todoText) return;

                todos.push({
                    text: todoText,
                    completed: false,
                    id: Date.now(),
                });

                document.getElementById("todoInput").value = "";
                renderTodos();
                saveTodosToStorage();
            }

            function renderTodos() {
                const todoList = document.getElementById("todoList");
                todoList.innerHTML = "";

                todos.forEach((todo) => {
                    const todoItem = document.createElement("div");
                    todoItem.className = `todo-item ${todo.completed ? "completed" : ""}`;
                    todoItem.innerHTML = `
                    <input type="checkbox" class="todo-checkbox" ${todo.completed ? "checked" : ""}
                           onchange="toggleTodo(${todo.id})">
                    <span class="todo-text">${todo.text}</span>
                    <button class="delete-btn" onclick="deleteTodo(${todo.id})">×</button>
                `;
                    todoList.appendChild(todoItem);
                });
            }

            function toggleTodo(id) {
                const todo = todos.find((t) => t.id === id);
                if (todo) {
                    todo.completed = !todo.completed;
                    renderTodos();
                    saveTodosToStorage();
                }
            }

            function deleteTodo(id) {
                todos = todos.filter((t) => t.id !== id);
                renderTodos();
                saveTodosToStorage();
            }

            function clearCompleted() {
                todos = todos.filter((t) => !t.completed);
                renderTodos();
                saveTodosToStorage();
            }

            function saveTodos() {
                let data = "";
                todos.forEach((todo) => {
                    if (todo.completed) {
                        data += `[DONE] ${todo.text}\n`;
                    } else {
                        data += `[ ] ${todo.text}\n`;
                    }
                });

                const blob = new Blob([data], { type: "text/plain" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "todos.txt";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            function loadTodos() {
                const input = document.createElement("input");
                input.type = "file";
                input.accept = ".txt";
                input.onchange = function (e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            const lines = e.target.result
                                .split("\n")
                                .filter((line) => line.trim());
                            todos = [];
                            lines.forEach((line) => {
                                line = line.trim();
                                let completed = false;
                                let text = "";

                                if (line.startsWith("[DONE]")) {
                                    completed = true;
                                    text = line.substring(6).trim();
                                } else if (line.startsWith("[ ]")) {
                                    completed = false;
                                    text = line.substring(3).trim();
                                } else if (
                                    line.startsWith("[X]") ||
                                    line.startsWith("[x]")
                                ) {
                                    completed = true;
                                    text = line.substring(3).trim();
                                } else if (line) {
                                    // Plain text line, assume not completed
                                    text = line;
                                    completed = false;
                                }

                                if (text) {
                                    todos.push({
                                        text: text,
                                        completed: completed,
                                        id: Date.now() + Math.random(),
                                    });
                                }
                            });
                            renderTodos();
                            saveTodosToStorage();
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            }

            // Enter key event listeners
            document
                .getElementById("eventInput")
                .addEventListener("keypress", function (e) {
                    if (e.key === "Enter") {
                        addEvent();
                    }
                });

            document
                .getElementById("todoInput")
                .addEventListener("keypress", function (e) {
                    if (e.key === "Enter") {
                        addTodo();
                    }
                });

            // Initialize the app
            renderCalendar();
            loadFileState();
            renderTodos();

            // Load selected date events if any
            if (selectedDate) {
                displayEventsForDate(selectedDate);
            }
        </script>
    </body>
</html>
