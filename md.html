<!DOCTYPE html>
<html>
<head>
    <title>Markdown Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            display: flex;
            height: 100vh;
            margin: 0;
        }

        #editor {
            flex: 1;
            padding: 10px;
            font-family: monospace;
            border: 1px solid #ccc;
            resize: none;
        }

        #preview {
            flex: 1;
            padding: 10px;
            border: 1px solid #ccc;
            overflow-y: auto;
        }

        #controls {
            padding: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <textarea id="editor"></textarea>
    <div id="preview"></div>
    <div id="controls">
        <button onclick="updatePreview()">Preview</button>
        <button onclick="saveMarkdown()">Save as Markdown</button>
        <button onclick="savePDF()">Save as PDF</button>
    </div>

    <script>
        const editor = document.getElementById('editor');
        const preview = document.getElementById('preview');
        const converter = new showdown.Converter();

        function updatePreview() {
            const markdownText = editor.value;
            const html = converter.makeHtml(markdownText);
            preview.innerHTML = html;
        }

        function saveMarkdown() {
            const markdownText = editor.value;
            const blob = new Blob([markdownText], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'document.md';
            a.click();
            URL.revokeObjectURL(url);
        }

        function savePDF() {
            updatePreview(); // Ensure preview is up-to-date
            const element = preview;
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            pdf.html(element, {
              callback: function(pdf) {
                pdf.save('document.pdf');
              },
              x: 10,
              y: 10,
              width: pdf.internal.pageSize.getWidth() - 20,
              windowWidth: element.offsetWidth
            });

        }

        editor.addEventListener('input', updatePreview);
        updatePreview(); // Initial preview
    </script>
</body>
</html>
